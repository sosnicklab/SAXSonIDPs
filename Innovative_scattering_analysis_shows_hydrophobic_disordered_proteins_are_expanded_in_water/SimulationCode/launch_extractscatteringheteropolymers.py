from LOADRUNREQs import *

proteins=[
    ('PNt','ALLH','MP0p7',
      [0., 0.423, 0.556, 0.662, 0.731, 0.784, 0.829, 0.857, 0.879, 0.894, 
       0.908, 0.92, 0.941, 0.957, 0.97, 0.979, 0.985, 0.992, 1.004, 1.019, 
       1.028, 1.032, 1.038, 1.046, 1.052, 1.058, 1.065, 1.071, 1.077, 1.082]
      ,[2.38617,0.,0.,0.,0.0080423,-0.0205101,0.0424275,-0.0900227,0.245588,-1.29597,-0.829119,-0.614417,-0.340401,-0.17982,-0.16531,0.0826548,-0.16531]
     ),
    ('FhuA','ALLH','MP0p7',
      [0., 0.423, 0.556, 0.662, 0.731, 0.784, 0.829, 0.857, 0.879, 0.894, 
       0.908, 0.92, 0.941, 0.957, 0.97, 0.979, 0.985, 0.992, 1.004, 1.019, 
       1.028, 1.032, 1.038, 1.046, 1.052, 1.058, 1.065, 1.071, 1.077, 1.082]
      ,[2.38617,0.,0.,0.,0.0080423,-0.0205101,0.0424275,-0.0900227,0.245588,-1.29597,-0.829119,-0.614417,-0.340401,-0.17982,-0.16531,0.0826548,-0.16531]
     ),
     ('PNt','HP','MP0p7',
      list((3.0*i for i in [0., 0.423, 0.556, 0.662, 0.731, 0.784, 0.829, 0.857, 0.879, 0.894, 
       0.908, 0.92, 0.941, 0.957, 0.97, 0.979, 0.985, 0.992, 1.004, 1.019, 
       1.028, 1.032, 1.038, 1.046, 1.052, 1.058, 1.065, 1.071, 1.077, 1.082]))
      ,[2.38617,0.,0.,0.,0.0080423,-0.0205101,0.0424275,-0.0900227,0.245588,-1.29597,-0.829119,-0.614417,-0.340401,-0.17982,-0.16531,0.0826548,-0.16531]
     )]

for nmi,homorama,TYPEi,AMPS,PARAMS in proteins:
    #TYPE='%s_%s' % (TYPEi,rep)
    for MPDFIRE in range(0,len(AMPS)):
        #prefix='%s_%s' % (nmi,rep)
        nm=nmi+'_'+homorama
        config=run_dir+'%s_%s_%s' % (nm,MPDFIRE,TYPEi)
        for rep in range(0,5):
            configfull='%s_%s_sim.h5' % (config,rep)
            with tb.open_file(configfull) as t:
                if len(t.root.output.time[:])!=550:
                    print 'NOT DONE',configfull
                    continue
        tmpstring=['python','/fillin/extractaddsidechainandFOXSall.py','--configi=%s' % config]
        print tmpstring
        jobs=sp.check_output(tmpstring)
